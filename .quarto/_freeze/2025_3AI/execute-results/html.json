{
  "hash": "d475af6a1e52742bc6a12e3d660dbd61",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Big Data, Big Problems?\"\nsubtitle: \"Scalability of Mixed Models for<br>Clustered and Longitudinal Data\"\nauthor: Nicole Erler\nauthor-title: Department of Data Science & Biostatistics\ninstitute: Julius Center for Health Sciences and Primary Care\ndate: \"13 May 2025\"\ndate-format: long\ncontact: '[{{< fa solid house-user >}} nerler.com](\"https://nerler.com\") &emsp;&emsp; [{{< fa brands bluesky >}} nerler](https://bsky.app/profile/nerler.bsky.social)&emsp;&emsp; [{{< fa brands github >}} NErler](https://github.com/NErler)'\ntitle-slide-attributes:\n  data-background-image: \"images/wallpaper_blue.jpg\"\n  data-background-size: cover\n  data-background-opacity: \"0.3\"\nformat:\n  revealjs: \n    template-partials:\n      - styles/title-slide.html\n    center-title-slide: false\n    theme: [styles/mytheme.scss, styles/color-theme-nord.scss, styles/custom_styles.scss]\n    width: 1244\n    height: 700\n    embed-resources: false\n    slide-number: true\n    footer: '[{{< fa solid house-user >}} nerler.com](\"https://nerler.com\")\n&emsp;&emsp;&emsp;&emsp;\n[{{< fa brands bluesky >}} nerler](https://bsky.app/profile/nerler.bsky.social)&emsp;&emsp;&emsp;&emsp;\n[{{< fa brands github >}} NErler](https://github.com/NErler)'\ninclude-after-body: styles/title-slide-footer.html\nknitr:\n  opts_chunk: \n    out.width: 100%\n    fig.width: 7\n    fig.height: 3.5\n    fig.align: center\n    dpi: 600\n    dev.args:\n      bg: transparent\n    fontsize: 2em\n    slide-number: true\nhtml-table-processing: none\n---\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n# Motivation {.h1section}\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## My Data: Continuous Monitoring\n\n<img src=\"images/MonitoringDevice.png\" id = \"wearable\" height= 500>\n\n<br>\n\nPatients at the general nursing ward.\n\n<br>\n\nRepeated measurements (every 20 sec) of\n\n* heart rate\n* blood pressure\n* body temperature\n* oxygen saturation\n* respiration\n* ...\n\n\n\n# The Linear Mixed Model{.h1section}\n\n## Data for Mixed Models\n\n::::{.columns}\n\n:::{.column width=60%}\n\nMinimal data structure for a (linear) mixed model:\n\n<br>\n\n::::: {.fragment fragment-index=1}\n\n* \"Clustered\" data<br>\n  &#8680; e.g., patients in different hospitals\n:::::\n\n::::: {.fragment fragment-index=2}\n\n* repeated measurements of the same subjects\n:::::\n:::\n\n:::{.column width=40%}\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::::{.r-stack}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatablarge\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::::: {.fragment fragment-index=2 style=\"background-color: #242933;\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatablarge\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:left;\"> setting </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.5 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.6 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> D </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.5 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.1 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::::\n\n:::::{.fragment style = \"background-color: #242933;\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatablarge\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> time </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.4 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.5 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.6 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.5 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 4.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::::\n\n:::::{.fragment style = \"background-color: #242933;\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatablarge\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> \\(x_1\\) </th>\n   <th style=\"text-align:right;\"> \\(x_2\\) </th>\n   <th style=\"text-align:left;\"> \\(x_3\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.4 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.9 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.5 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.6 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 2.9 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.5 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 4.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1.9 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 3.0 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(45, 50, 59, 255) !important;\"> 0.4 </td>\n   <td style=\"text-align:left;background-color: rgba(45, 50, 59, 255) !important;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::::\n::::::\n\n:::\n::::\n\n\n\n\n\n\n## Linear Mixed Model\n\n<br>\n\nFor patient $i$ at time $t$:\n\n$$\ny_{i}(t) = \n\\underset{\\text{fixed effects}}{\\underbrace{\\mathbf x_{i}(t)^\\top \\boldsymbol{\\beta}}} + \n\\underset{\\text{random effects}}{\\underbrace{\\mathbf z_{i}(t)^\\top \\mathbf{b_{i}}}} + \n\\varepsilon_i(t)\n$$\n\n$$\\text{with}\\quad \\mathbf b_i \\sim N(\\mathbf 0, \\mathbf D) \\quad\\text{and}\n\\quad \\varepsilon_i(t) \\sim N(0, \\sigma^2)\n$$\n\n:::{.sgrey}\n\n* $\\mathbf x_i(t)^\\top$: vector of covariates\n* $\\mathbf z_i(t)^\\top$: vector of covariates with patient-specific effects\n\n* $\\boldsymbol\\beta$: fixed (population) effects\n* $\\mathbf b_i$: random (patient-specific) effects\n\n* $\\varepsilon_i(t)$: residual error\n\n:::\n\n## Random Intercept & Slope Model\n\n<br>\n\nFor example,\n\n$$y_i(t) = \\underset{\\text{fixed effects}}{\\underbrace{\\beta_0 + \\beta_1 t}} +\n  \\underset{\\text{random effects}}{\\underbrace{b_{i0} + b_{i1} t}} + \\varepsilon_i(t)$$\nwith\n$$\\mathbf b_i = \\begin{bmatrix}\nb_{i0}\\\\b_{i1}\n\\end{bmatrix} \\sim N\\left( \\begin{bmatrix}0\\\\0\\end{bmatrix}, \\begin{bmatrix}d_{11} & d_{12}\\\\d_{21} & d_{22}\\end{bmatrix}\\right)\n$$\n\n\n\n\n## Mixed Models Visualized\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.r-stack}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::{.fragment}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n:::{.fragment}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n::::\n\n\n## Mixed Models Visualized\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-14-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n## Example: Non-linear Trajectories\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/bili-fit-fixed-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n# Big Data {background-image=\"images/galaxy.jpg\" background-size=\"fill\" background-color=\"black\" .center .bigdata}\n\n<!-- ## Big Data -->\n\n<!-- <br> -->\n<!-- <br> -->\n\n<!-- > Your data are not large if using the naive [...] approach takes less time than -->\n<!--   finding and reading the documentation that describes how to do what you want -->\n<!--   to do efficiently. -->\n\n<!-- :::{.quoteauthor} -->\n<!-- **Douglas Bates**, author of the **lme4** R-package -->\n<!-- ::: -->\n\n## Scenario 1: Many Clusters (i.e., many patients)\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n:::{.column width=\"30%\"}\n\n<br>\n<br>\n**Example:**<br>\nlarge longitudinal study\n:::\n\n:::{.column width=\"70%\"}\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class='datatab-scen'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> \\(x_1\\) </th>\n   <th style=\"text-align:right;\"> \\(x_2\\) </th>\n   <th style=\"text-align:left;\"> \\(x_3\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.4 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:right;\"> 2.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.6 </td>\n   <td style=\"text-align:right;\"> 2.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.5 </td>\n   <td style=\"text-align:right;\"> 4.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n<img src=\"images/arrow.png\" id = arrow1>\n:::\n::::\n\n\n\n## Scenario 2: Many Repeated Measurements\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n:::{.column width=\"30%\"}\n<br>\n<br>\n\n\n**Example:**\n\n* Data from wearables\n* \"time-series\"\n:::\n\n:::{.column width=\"70%\"}\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class='datatab-scen'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> \\(x_1\\) </th>\n   <th style=\"text-align:right;\"> \\(x_2\\) </th>\n   <th style=\"text-align:left;\"> \\(x_3\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.4 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:right;\"> 2.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.6 </td>\n   <td style=\"text-align:right;\"> 2.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3.5 </td>\n   <td style=\"text-align:right;\"> 4.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n<img src=\"images/arrow.png\" id = arrow2a>\n<img src=\"images/arrow.png\" id = arrow2b>\n<img src=\"images/arrow.png\" id = arrow2c>\n:::\n::::\n\n\n## Scenario 3: Many Covariates\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n:::{.column width=\"25%\"}\n\n\n<br>\n<br>\n\n**Example:**<br>\ngenetic markers\n:::\n\n:::{.column width=\"75%\"}\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class='datatab-scen'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> y </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> \\(x_1\\) </th>\n   <th style=\"text-align:right;\"> \\(x_2\\) </th>\n   <th style=\"text-align:left;\"> \\(x_3\\) </th>\n   <th style=\"text-align:left;\"> \\(x_4\\) </th>\n   <th style=\"text-align:left;\"> ... </th>\n   <th style=\"text-align:left;\"> ... </th>\n   <th style=\"text-align:left;\"> ... </th>\n   <th style=\"text-align:left;\"> \\(x_p\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.4 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:right;\"> 2.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.6 </td>\n   <td style=\"text-align:right;\"> 2.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.5 </td>\n   <td style=\"text-align:right;\"> 4.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n<img src=\"images/arrow.png\" id = arrow3>\n:::\n::::\n\n\n\n## Scenario 4: Many Outcomes\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n:::{.column width=\"35%\"}\n<br>\n<br>\n\n\n**Example:**<br>\nRepeated imaging/omics data\n:::\n\n:::{.column width=\"65%\"}\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class='datatab-scen'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> id </th>\n   <th style=\"text-align:right;\"> \\(y_1\\) </th>\n   <th style=\"text-align:left;\"> \\(y_2\\) </th>\n   <th style=\"text-align:left;\"> \\(y_3\\) </th>\n   <th style=\"text-align:left;\"> ... </th>\n   <th style=\"text-align:left;\"> ... </th>\n   <th style=\"text-align:left;\"> \\(y_K\\) </th>\n   <th style=\"text-align:right;\"> time </th>\n   <th style=\"text-align:right;\"> \\(x_1\\) </th>\n   <th style=\"text-align:right;\"> \\(x_2\\) </th>\n   <th style=\"text-align:left;\"> \\(x_3\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.4 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 2.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.6 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 2.9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.5 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 4.1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> B </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 1.9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> A </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:left;\"> \\(\\ldots\\) </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> C </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n<img src=\"images/arrow.png\" id = arrow4>\n:::\n::::\n\n## My Data: Continuous Monitoring\n\n::::{.columns}\n\n:::{.column width=\"45%\"}\n\n<br>\n\n* N = 916 patients (for now...)\n* follow-up: 1 hr - 27 days\n* measurements every 20 seconds\n  * 180 obs./hour &#8680; 4320 obs./day\n\n&#8680; 9.3 million rows\n\n:::{.fragment}\n<br>\n\n* 6 outcomes of interest\n:::\n\n:::{.fragment}\n[ &#8680; **Scenario 2** with additional challenges]{.red}\n:::\n\n:::\n\n:::{.column width=\"55%\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n<img src=\"images/hr_example_1p.png\" id = \"hr\">\n:::\n::::\n\n\n# Scalability {.center .middle}\n\n## Scenario 1 & 2: Number of Observations\n\n:::{style=\"font-size: 1.4rem;\"}\n$$y_{ij} = \\beta_0  + \\beta_1 t_{ij} + b_{i0} + b_{i1} t_{ij} + \\varepsilon_{ij},\n\\quad i = 1,\\ldots, \\bbox[#516682, 6px]{N}, \\quad j = 1,\\ldots, \\bbox[#906E8A, 6px]{J}$$\n:::\n\n\n\n::: {.cell layout-align=\"center\" class='fragment'}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-24-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Scenario 1 & 2: Number of Observations\n\n:::{style=\"font-size: 1.4rem;\"}\n$$y_{ij} = \\beta_0  + \\beta_1 t_{ij} + b_{i0} + b_{i1} t_{ij} + \\varepsilon_{ij},\n\\quad i = 1,\\ldots, \\bbox[#516682, 6px]{N}, \\quad j = 1,\\ldots, \\bbox[#906E8A, 6px]{J}$$\n:::\n\n\n::::{.columns}\n:::{.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:right;\"> J </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(81, 102, 130, 255) !important;\"> 1 000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(68, 89, 116, 255) !important;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(81, 102, 130, 255) !important;\"> 10 000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(68, 89, 116, 255) !important;\"> 20 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(81, 102, 130, 255) !important;\"> 100 000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(68, 89, 116, 255) !important;\"> 200 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(81, 102, 130, 255) !important;\"> 1.0 mil </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(68, 89, 116, 255) !important;\"> 2.0 mil </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(81, 102, 130, 255) !important;\"> 10.0 mil </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(68, 89, 116, 255) !important;\"> 20.0 mil </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n:::{.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:right;\"> J </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 5 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 100 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 10000 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n::::\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-27-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n## Parameter Estimation in the (Linear) Mixed Model\n\nConditional formulation, given the [unobserved random effects $\\mathbf b_i$]{.blue .strong}:\n\n$$\\mathbf y_i \\color{var(--nord10)}{\\mid \\mathbf b_i} \\sim N\\left(\\mathbf X_i \\boldsymbol\\beta \\color{var(--nord10)}{+ \\mathbf Z_i\\mathbf b_i},\\; \\sigma^2 \\mathbf I\\right)$$\n**Integrating** over the random effects...\n$$f(\\mathbf y_i) = \\color{var(--nord11)}{\\int} f(\\mathbf y_i \\mid \\mathbf b_i)\\; f(\\mathbf b_i) \\; \\color{var(--nord11)}{d\\mathbf b_i}$$\n...results in the **marginal model**:\n$$\\mathbf y_i \\sim N(\\mathbf X_i \\boldsymbol\\beta,\\; \\color{var(--nord14)}{\\mathbf Z_i \\mathbf D \\mathbf Z_i^\\top} + \\sigma^2 \\mathbf I)$$\n\n:::{.fragment}\n\n:::{style=\"text-align: center;\"}\n[{{< fa regular smile >}}]{.green} fewer parameters to estimate\n&emsp;&emsp;\n[{{< fa regular frown >}}]{.red} integration\n:::\n:::\n\n\n\n\n## Scenario 3: Covariate Terms\n\n$$y_{ij} = \\beta_0 + \\bbox[#516682, 8px]{\\beta_1 t_{ij} + \\beta_2 x_{ij1} + \\ldots + \\beta_p x_{ijp}} +\nb_{i0} + b_{i1} t_{ij} + \\varepsilon_{ij}, \\quad {\\scriptsize\\begin{array}{l}i = 1,\\ldots, 2000\\\\j = 1,\\ldots, 10\\end{array}}$$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-28-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n## Scenario 3: Covariate Terms\n\n$$y_{ij} = \\beta_0 + \\bbox[#516682, 8px]{\\beta_1 t_{ij} + \\beta_2 x_{ij1} + \\ldots + \\beta_p x_{ijp}} +\nb_{i0} + b_{i1} t_{ij} + \\varepsilon_{ij}, \\quad {\\scriptsize\\begin{array}{l}i = 1,\\ldots, 2000\\\\j = 1,\\ldots, 10\\end{array}}$$\n\n::::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:right;\"> J </th>\n   <th style=\"text-align:left;\"> # obs </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2 000 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> 20 000 </td>\n   <td style=\"text-align:right;background-color: rgba(81, 102, 130, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 4 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 000 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> 20 000 </td>\n   <td style=\"text-align:right;background-color: rgba(81, 102, 130, 255) !important;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 4 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 000 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> 20 000 </td>\n   <td style=\"text-align:right;background-color: rgba(81, 102, 130, 255) !important;\"> 100 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 4 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 000 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> 20 000 </td>\n   <td style=\"text-align:right;background-color: rgba(81, 102, 130, 255) !important;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 4 000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n:::{.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-30-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n::::\n\n\n\n## Scenario 4: Number of Outcome Variables\n\n$$\n\\begin{array}{ccl}\ny_{ij\\color{var(--nord11)}{1}} &=&\\beta_{0\\color{var(--nord11)}{1}} + \\beta_{1\\color{var(--nord11)}{1}} t_{ij\\color{var(--nord11)}{1}}  + b_{i0\\color{var(--nord11)}{1}} + b_{i1\\color{var(--nord11)}{1}} t_{ij\\color{var(--nord11)}{1}} + \\varepsilon_{ij\\color{var(--nord11)}{1}}\\\\\n\\vdots & \\vdots & \\vdots\\\\\ny_{ij\\color{var(--nord11)}{K}} &=&\\beta_{0\\color{var(--nord11)}{K}} + \\beta_{1\\color{var(--nord11)}{K}} t_{ij\\color{var(--nord11)}{K}}  + b_{i0\\color{var(--nord11)}{K}} + b_{i1\\color{var(--nord11)}{K}} t_{ij\\color{var(--nord11)}{K}} + \\varepsilon_{ij\\color{var(--nord11)}{K}}\n\\end{array} \\quad {\\scriptsize\\begin{array}{l}i = 1,\\ldots, N\\\\j = 1,\\ldots, J\\\\\\bbox[#BF616A, 2pt]{k = 1, \\ldots, K}\\end{array}}\n$$\n\nwith\n\n$$\\mathbf b_i = \\begin{pmatrix} b_{i0\\color{var(--nord11)}{1}} \\\\ \n  b_{i1\\color{var(--nord11)}{1}}\\\\ \\vdots \\\\ b_{i0\\color{var(--nord11)}{K}} \\\\\n  b_{i1\\color{var(--nord11)}{K}} \\end{pmatrix} \\sim N(\\mathbf 0, \\mathbf D)\n\\qquad \\text{and}\\qquad\n\\varepsilon_{ij\\color{var(--nord11)}{k}} \\sim N(0, \\sigma_\\color{var(--nord11)}{k}^2 \\mathbf I)$$\n\n\n## Scenario 4: Number of Outcome Variables\n\n\n::::{.columns}\n:::{.column width=\"50%\"}\n\n<br>\n\nFor the intercept & slope model:\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> J </th>\n   <th style=\"text-align:right;\"> K </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 10 </td>\n   <td style=\"text-align:left;\"> 4 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 21 </td>\n   <td style=\"text-align:left;\"> 6 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 36 </td>\n   <td style=\"text-align:left;\"> 8 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 5 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 55 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 10 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 210 </td>\n   <td style=\"text-align:left;\"> 20 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 100 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 20 100 </td>\n   <td style=\"text-align:left;\"> 200 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 2.0 mil </td>\n   <td style=\"text-align:left;\"> 2.0 mil </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:left;\"> 10 000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 5000 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:right;\"> 5000 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 50.0 mil </td>\n   <td style=\"text-align:left;\"> 10.0 mil </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n:::{.column width=\"50%\"}\n\n<br>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-32-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n:::\n::::\n\n\n\n## Scenario 5 (!): Random Effect Terms\n\n$$y_{ij} = \\beta_0  + \\beta_1 t_{ij} + \\ldots + \\beta_p t_{ij}^p +\n\\bbox[#906E8A, 8px]{b_{i0} + b_{i1} t_{ij} + \\ldots + b_{ip} t_{ij}^p} + \n\\varepsilon_{ij}, \\quad {\\scriptsize\\begin{array}{l}i = 1,\\ldots, 50\\\\j = 1,\\ldots, 100\\end{array}}$$\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-33-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n\n\n## Scenario 5 (!): Random Effect Terms\n\n$$y_{ij} = \\beta_0  + \\beta_1 t_{ij} + \\ldots + \\beta_p t_{ij}^p +\n\\bbox[#906E8A, 8px]{b_{i0} + b_{i1} t_{ij} + \\ldots b_{ip} t_{ij}^p} + \n\\varepsilon_{ij}, \\quad {\\scriptsize\\begin{array}{l}i = 1,\\ldots, N\\\\j = 1,\\ldots, J\\end{array}}$$\n\n::::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:right;\"> N </th>\n   <th style=\"text-align:right;\"> J </th>\n   <th style=\"text-align:right;\"> # rd. effect terms </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 6 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 10 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 15 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 55 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 50 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 1275 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 2500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;background-color: rgba(144, 110, 138, 255) !important;\"> 100 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 5050 </td>\n   <td style=\"text-align:right;color: rgba(195, 157, 188, 255) !important;\"> 5000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n:::{.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-36-1.png){fig-align='center' width=85%}\n:::\n:::\n\n:::\n::::\n\n\n## Conclusion\n\n<br>\n\n**Scenario 1 & 2: Many clusters/patients or many repeated measurements**\n\n* LMM probably feasible\n* for extreme $N$: split the data, fit models in parallel, combine\n* for extreme $J$: splitting possible, but combining maybe more complex\n\n<br>\n\n:::{.fragment}\n**Scenario 3: Many covariates**\n\n* LMM probably feasible\n* regularization (e.g., ridge, lasso) may be a good idea\n\n:::\n\n## Conclusion\n\n<br>\n\n**Scenario 4: Many outcome variables**\n\n* Potentially serious challenges!\n* LMM feasible for small $K$ and few random effects terms\n* **Software**: more limited, typically Bayesian (cond. model)\n\n:::{.fragment}\nAlternatives to the full multivariate model:\n\n* stacking the data & use interaction with outcome indicator\n* pairwise approach\n* simplify the structure of $\\mathbf D$ (e.g., diagonal)\n\n:::\n\n## Stacking the Data\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n:::{.column width=\"60%\"}\nInteraction with an indicator variable:\n<br>\n$$\n\\begin{align} y_{ij} = & (\\beta_0 + b_{i01}) + (\\beta_1 + b_{i11}) t_{ij} \\\\\n& + (\\beta_2  + b_{i02})\\ I(\\color{var(--nord11)}{k = 2}) + \n (\\beta_3  + b_{i12})\\ I(\\color{var(--nord11)}{k = 2})t_{ij}\\\\\n  & + \\ldots +\\\\\n&  + (\\beta_{p-1}  + b_{i0K})\\ I(\\color{var(--nord11)}{k = K})  + \n (\\beta_p + b_{i1K})\\ I(\\color{var(--nord11)}{k = K}) t_{ij}\\\\\n& + \\varepsilon_{ij}\n\\end{align}\n$$\n\n&#8680; specify weights to accommodate $\\sigma_\\color{var(--nord11)}{1}, \\ldots, \\sigma_\\color{var(--nord11)}{K}$\n:::\n\n:::{.column width=\"40%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab-scen\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> \\(\\color{var(--nord11)}{k}\\) </th>\n   <th style=\"text-align:left;\"> time </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> y1 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:left;\"> y1 </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> y1 </td>\n   <td style=\"text-align:left;\"> 9.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> 1 </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> y2 </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> y2 </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> \\(\\vdots\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> 1 </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> y2 </td>\n   <td style=\"text-align:left;background-color: rgba(40, 45, 54, 255) !important;\"> 7.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> y1 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n   <td style=\"text-align:left;\"> y1 </td>\n   <td style=\"text-align:left;\"> \\(\\vdots\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n::::\n\n:::{.fragment}\n::::{.columns}\n:::{.column width=\"50%\"}\n[{{< fa regular smile >}}]{.green} standard LMM software<br>\n[{{< fa regular smile >}}]{.green} works for unbalanced data\n:::\n\n:::{.column width=\"50%\"}\n[{{< fa regular frown >}}]{.red} only for outcomes of the same type\n:::\n::::\n\n:::\n\n## Pairwise approach\n\nFit models for all pairs of outcomes:\n$$(y_1, y_2), (y_1, y_3), (y_2, y_3), \\ldots, (y_{K-1}, y_K)$$\n\n* average parameters estimated in multiple models\n  e.g., $\\beta_{11}$ is estimated in $(y_1, y_2)$, $(y_1, y_3)$, ...\n  \n* Pairwise models can be run in parallel.\n* Doesn't work in joint models.\n\n\n## Conclusion\n\n<br>\n\n**Scenario 5: Random Effect Terms**\n\n* feasible for moderate number of random effects terms (e.g., &le; 10) and \n  sample size (e.g., N = 1000)\n* larger models/data may require simplification of $\\mathbf D$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"datatab\">\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">data</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">parameters</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:right;\"> J </th>\n   <th style=\"text-align:right;\"> K </th>\n   <th style=\"text-align:left;\"> # obs </th>\n   <th style=\"text-align:right;\"> rd </th>\n   <th style=\"text-align:right;\"> \\(\\# \\boldsymbol\\beta\\) </th>\n   <th style=\"text-align:right;\"> \\(\\# \\sigma\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf D\\) </th>\n   <th style=\"text-align:left;\"> \\(\\# \\mathbf b\\) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 5 </td>\n   <td style=\"text-align:left;\"> 50.0 mil </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 1 275 </td>\n   <td style=\"text-align:left;\"> 50 000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 000 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:right;background-color: rgba(147, 80, 86, 255) !important;\"> 6 </td>\n   <td style=\"text-align:left;\"> 60.0 mil </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;color: rgba(211, 116, 125, 255) !important;\"> 1 830 </td>\n   <td style=\"text-align:left;\"> 60 000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n# More Challenges!\n\n\n## Estimation of the Random Effects\n\n**Empirical Bayes** estimate:\n\n$$\\mathbf{\\hat b}_i = \\widehat{\\mathbf D} \\mathbf Z_i^\\top \\left(\\mathbf Z_i \\mathbf{\\widehat D} \\mathbf Z_i^\\top + \\sigma^2 \\mathbf I\\right)^{-1} (\\mathbf y_i - \\mathbf x_i^\\top \\boldsymbol{\\hat\\beta})$$\n\n* $\\widehat{\\mathbf D}$ is a $10 \\times 10$ matrix\n* $\\mathbf Z_i$ is a $10\\ 000 \\times 10$ matrix\n\n&#8680; $\\mathbf Z_i \\mathbf{\\widehat D} \\mathbf Z_i^\\top$ is $10\\ 000 \\times 10\\ 000$ (or larger)\n\n\n## Matrix Inversion\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n:::{.r-stack}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-41-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\" class='fragment'}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-42-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\" class='fragment'}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-43-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n\n\n\n\n\n## My Data\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n<img src=\"images/hrexample.png\" id = \"hr\">\n\n## My Model \n\n\n::: {.cell layout-align=\"center\"}\n<style type=\"text/css\">\n:root {\n  --nord15: #B48EAD;\n  --nord10: #5E81AC;\n  --nord8: #88C0D0;\n  --nord11: #BF616A;\n  --nord14: #A3BE8C;\n}\n\n</style>\n:::\n\n\n\\begin{align*}\ny_{i}(t) = & \\beta_0 + \\color{var(--nord15)}{b_{i0}} + (\\beta_1 + \\color{var(--nord15}{b_{i1}})\\; t \\;+ \\\\\n& (\\beta_2 + \\color{var(--nord15)}{b_{i2}}) \\sin\\left(2\\pi \\frac{t\\bmod 24}{24}\\right) +\n    (\\beta_3 + \\color{var(--nord15)}{b_{i3}}) \\cos\\left(2\\pi \\frac{t\\bmod 24}{24}\\right) +\\\\\n& (\\beta_4 + \\color{var(--nord15)}{b_{i4}}) \\sin\\left(2\\pi \\frac{t\\bmod 24}{12}\\right) + \n  (\\beta_5 + \\color{var(--nord15)}{b_{i5}}) \\cos\\left(2\\pi \\frac{t\\bmod 24}{12}\\right) +\\\\\n& (\\beta_6 + \\color{var(--nord15)}{b_{i6}}) \\;t\\sin\\left(2\\pi \\frac{t\\bmod 24}{24}\\right) + \n  (\\beta_7 + \\color{var(--nord15)}{b_{i7}}) \\;t\\cos\\left(2\\pi \\frac{t\\bmod 24}{24}\\right) +\\\\\n& (\\beta_8 + \\color{var(--nord15)}{b_{i8}}) \\;t\\sin\\left(2\\pi \\frac{t\\bmod 24}{12}\\right) +\n  (\\beta_9 + \\color{var(--nord15)}{b_{i9}}) \\;t\\cos\\left(2\\pi \\frac{t\\bmod 24}{12}\\right) +\\\\\n& \\varepsilon_i(t)\n\\end{align*}\n\n## My Model\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2025_3AI_files/figure-revealjs/unnamed-chunk-46-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n# Thank You{.the-end .center .middle .no-footer}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"2025_3AI_files/libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"2025_3AI_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}